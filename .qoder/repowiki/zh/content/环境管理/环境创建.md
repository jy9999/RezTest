# ç¯å¢ƒåˆ›å»º

<cite>
**æœ¬æ–‡æ¡£ä¸­å¼•ç”¨çš„æ–‡ä»¶**  
- [package.py](file://my_packages/myapp/1.0.0/package.py)
- [package.py](file://my_packages/python/3.10.0/package.py)
- [package.py](file://my_packages/maya/2022/package.py)
- [resolver.py](file://rez-3.3.0/src/rez/resolver.py)
- [solver.py](file://rez-3.3.0/src/rez/solver.py)
- [resolved_context.py](file://rez-3.3.0/src/rez/resolved_context.py)
- [create_package_example.py](file://create_package_example.py)
</cite>

## ç›®å½•
1. [ç®€ä»‹](#ç®€ä»‹)
2. [åŒ…å®šä¹‰ä¸ä¾èµ–å£°æ˜](#åŒ…å®šä¹‰ä¸ä¾èµ–å£°æ˜)
3. [ä¾èµ–è§£ææœºåˆ¶](#ä¾èµ–è§£ææœºåˆ¶)
4. [å˜ä½“ä¸æ¡ä»¶ä¾èµ–](#å˜ä½“ä¸æ¡ä»¶ä¾èµ–)
5. [ç¯å¢ƒé…ç½®æ–‡ä»¶ç¼–å†™è§„èŒƒ](#ç¯å¢ƒé…ç½®æ–‡ä»¶ç¼–å†™è§„èŒƒ)
6. [å¸¸è§é”™è¯¯ä¸è°ƒè¯•æ–¹æ³•](#å¸¸è§é”™è¯¯ä¸è°ƒè¯•æ–¹æ³•)
7. [æ€§èƒ½ä¼˜åŒ–å»ºè®®](#æ€§èƒ½ä¼˜åŒ–å»ºè®®)
8. [å®é™…ä»£ç ç¤ºä¾‹](#å®é™…ä»£ç ç¤ºä¾‹)
9. [ç»“è®º](#ç»“è®º)

## ç®€ä»‹

Rez æ˜¯ä¸€ä¸ªå¼ºå¤§çš„åŒ…ç®¡ç†ç³»ç»Ÿï¼Œç”¨äºç®¡ç†è½¯ä»¶ä¾èµ–å’Œåˆ›å»ºå¯é‡å¤çš„å¼€å‘ç¯å¢ƒã€‚æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»äº†å¦‚ä½•é€šè¿‡ `package.py` å®šä¹‰åŒ…ä¾èµ–å¹¶ç”Ÿæˆè§£æä¸Šä¸‹æ–‡ï¼ŒåŸºäº `resolver.py` ä¸­çš„ä¾èµ–è§£ææœºåˆ¶æè¿°ç¯å¢ƒåˆ›å»ºæ—¶çš„ç‰ˆæœ¬æ±‚è§£è¿‡ç¨‹ã€‚æˆ‘ä»¬å°†æ¢è®¨å¦‚ä½•ä½¿ç”¨ `requires` å­—æ®µå£°æ˜ä¾èµ–é¡¹ï¼Œä»¥åŠå¦‚ä½•å¤„ç†å˜ä½“ï¼ˆvariantsï¼‰å’Œæ¡ä»¶ä¾èµ–ã€‚æ­¤å¤–ï¼Œè¿˜å°†æä¾›åˆ›å»ºå¸¦å‘½åå˜ä½“ã€å¤šç‰ˆæœ¬å…±å­˜ç¯å¢ƒçš„å®é™…ä»£ç ç¤ºä¾‹ï¼Œå¹¶æ¶µç›–ç¯å¢ƒé…ç½®æ–‡ä»¶çš„ç¼–å†™è§„èŒƒã€å¸¸è§é”™è¯¯åŠè°ƒè¯•æ–¹æ³•ï¼Œå¦‚ä¾èµ–å†²çªçš„è¯†åˆ«ä¸è§£å†³ã€‚æœ€åï¼ŒåŒ…æ‹¬æ€§èƒ½ä¼˜åŒ–å»ºè®®ï¼Œä¾‹å¦‚ç¼“å­˜ç­–ç•¥å’Œæœ€å°åŒ–ä¾èµ–é›†ã€‚

**Section sources**
- [README.md](file://README.md#L1-L155)

## åŒ…å®šä¹‰ä¸ä¾èµ–å£°æ˜

åœ¨ Rez ä¸­ï¼Œæ¯ä¸ªåŒ…éƒ½ç”±ä¸€ä¸ª `package.py` æ–‡ä»¶å®šä¹‰ï¼Œè¯¥æ–‡ä»¶åŒ…å«äº†åŒ…çš„åŸºæœ¬ä¿¡æ¯å’Œä¾èµ–å…³ç³»ã€‚ä»¥ä¸‹æ˜¯ `myapp` åŒ…çš„ `package.py` æ–‡ä»¶å†…å®¹ï¼š

```python
name = "myapp"
version = "1.0.0"
description = "A sample Rez package"
authors = ["Your Name"]

# åŒ…çš„ä¾èµ–é¡¹ï¼ˆå¯é€‰ï¼‰
requires = []  # ç•™ç©ºè¡¨ç¤ºæ— ä¾èµ–

# å¯é€‰ï¼šå®šä¹‰ç³»ç»Ÿéœ€æ±‚
system_requires = []

# å¯é€‰ï¼šåœ¨ç¯å¢ƒä¸­åŠ è½½æ—¶æ‰§è¡Œçš„å‘½ä»¤
def commands():
    import os
    # è®¾ç½®ç¯å¢ƒå˜é‡
    env.MYAPP_ROOT = "{root}"
    env.PATH.append("{root}/bin")
    env.PYTHONPATH.append("{root}/lib")

# å¯é€‰ï¼šå®šä¹‰åŒ…çš„å˜ä½“ï¼ˆä¸åŒçš„é…ç½®ï¼‰
variants = [
    ["python-3.7"],
    ["python-3.9"],
    ["python-3.11"],
]

# å¯é€‰ï¼šé¡¹ç›®æ–‡ä»¶å¤¹
tools = []
```

åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œ`name` å’Œ `version` å­—æ®µå®šä¹‰äº†åŒ…çš„åç§°å’Œç‰ˆæœ¬ã€‚`requires` å­—æ®µç”¨äºå£°æ˜åŒ…çš„ä¾èµ–é¡¹ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²è¡¨ç¤ºä¸€ä¸ªä¾èµ–åŒ…åŠå…¶ç‰ˆæœ¬è¦æ±‚ã€‚ä¾‹å¦‚ï¼Œ`"python-3.7"` è¡¨ç¤ºéœ€è¦ Python 3.7 ç‰ˆæœ¬ã€‚`commands` å‡½æ•°å®šä¹‰äº†åœ¨ç¯å¢ƒä¸­åŠ è½½è¯¥åŒ…æ—¶è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œé€šå¸¸ç”¨äºè®¾ç½®ç¯å¢ƒå˜é‡ã€‚`variants` å­—æ®µå®šä¹‰äº†åŒ…çš„ä¸åŒé…ç½®ï¼Œæ¯ä¸ªé…ç½®å¯ä»¥æœ‰ä¸åŒçš„ä¾èµ–é¡¹ã€‚

**Section sources**
- [package.py](file://my_packages/myapp/1.0.0/package.py#L1-L33)

## ä¾èµ–è§£ææœºåˆ¶

Rez çš„ä¾èµ–è§£ææœºåˆ¶ä¸»è¦ç”± `resolver.py` æ–‡ä»¶ä¸­çš„ `Resolver` ç±»å®ç°ã€‚`Resolver` ç±»è´Ÿè´£è§£æåŒ…è¯·æ±‚å¹¶ç”Ÿæˆè§£æä¸Šä¸‹æ–‡ã€‚ä»¥ä¸‹æ˜¯ `Resolver` ç±»çš„ä¸»è¦æ–¹æ³•å’Œå±æ€§ï¼š

```python
class Resolver(object):
    """The package resolver.

    The Resolver uses a combination of Solver(s) and cache(s) to resolve a
    package request as quickly as possible.
    """
    def __init__(self, context, package_requests, package_paths, package_filter=None,
                 package_orderers=None, timestamp=0, callback=None, building=False,
                 testing=False, verbosity=False, buf=None, package_load_callback=None,
                 caching=True, suppress_passive=False, print_stats=False):
        """Create a Resolver.

        Args:
            package_requests: List of Requirement objects representing the
                request.
            package_paths: List of paths to search for pkgs.
            package_filter (`PackageFilterList`): Package filter.
            package_orderers (list of `PackageOrder`): Custom package ordering.
            callback: See `Solver`.
            package_load_callback: If not None, this callable will be called
                prior to each package being loaded. It is passed a single
                `Package` object.
            building: True if we're resolving for a build.
            testing: True if we're resolving for a rez (rez-test).
            caching: If True, cache(s) may be used to speed the resolve. If
                False, caches will not be used.
            print_stats (bool): If true, print advanced solver stats at the end.
        """
        self.context = context
        self.package_requests = package_requests
        self.package_paths = package_paths
        self.timestamp = timestamp
        self.callback = callback
        self.package_orderers = package_orderers
        self.package_load_callback = package_load_callback
        self.building = building
        self.testing = testing
        self.verbosity = verbosity
        self.caching = caching
        self.buf = buf
        self.suppress_passive = suppress_passive
        self.print_stats = print_stats

        # store hash of package orderers. This is used in the memcached key
        if package_orderers:
            sha1s = ''.join(x.sha1 for x in package_orderers)
            self.package_orderers_hash = sha1(sha1s.encode("utf8")).hexdigest()
        else:
            self.package_orderers_hash = ''

        # store hash of pre-timestamp-combined package filter. This is used in
        # the memcached key
        if package_filter:
            self.package_filter_hash = package_filter.sha1
        else:
            self.package_filter_hash = ''

        # combine timestamp and package filter into single filter
        if self.timestamp:
            if package_filter:
                self.package_filter = package_filter.copy()
            else:
                self.package_filter = PackageFilterList()
            rule = TimestampRule.after(self.timestamp)
            self.package_filter.add_exclusion(rule)
        else:
            self.package_filter = package_filter

        self.status_ = ResolverStatus.pending
        self.resolved_packages_ = None
        self.resolved_ephemerals_ = None
        self.failure_description = None
        self.graph_ = None
        self.from_cache = False
        self.memcached_servers = config.memcached_uri if config.resolve_caching else None

        self.solve_time = 0.0  # time spent solving
        self.load_time = 0.0   # time spent loading package resources

        self._print = config.debug_printer("resolve_memcache")

    @pool_memcached_connections
    def solve(self):
        """Perform the solve."""
        with log_duration(self._print, "memcache get (resolve) took %s"):
            solver_dict = self._get_cached_solve()

        if solver_dict:
            self.from_cache = True
            self._set_result(solver_dict)
        else:
            self.from_cache = False
            solver = self._solve()
            solver_dict = self._solver_to_dict(solver)
            self._set_result(solver_dict)

            with log_duration(self._print, "memcache set (resolve) took %s"):
                self._set_cached_solve(solver_dict)
```

`Resolver` ç±»çš„ `solve` æ–¹æ³•æ˜¯æ ¸å¿ƒï¼Œå®ƒé¦–å…ˆå°è¯•ä»ç¼“å­˜ä¸­è·å–å·²è§£æçš„ç»“æœã€‚å¦‚æœç¼“å­˜ä¸­æ²¡æœ‰ç»“æœï¼Œåˆ™è°ƒç”¨ `_solve` æ–¹æ³•è¿›è¡Œå®é™…çš„ä¾èµ–è§£æã€‚è§£æç»“æœä¼šè¢«å­˜å‚¨åˆ°ç¼“å­˜ä¸­ï¼Œä»¥ä¾¿åç»­è¯·æ±‚å¯ä»¥å¿«é€Ÿè·å–ã€‚

**Section sources**
- [resolver.py](file://rez-3.3.0/src/rez/resolver.py#L1-L475)

## å˜ä½“ä¸æ¡ä»¶ä¾èµ–

å˜ä½“ï¼ˆvariantsï¼‰æ˜¯ Rez ä¸­çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œå…è®¸ä¸€ä¸ªåŒ…æœ‰å¤šä¸ªä¸åŒçš„é…ç½®ã€‚æ¯ä¸ªå˜ä½“å¯ä»¥æœ‰ä¸åŒçš„ä¾èµ–é¡¹å’Œé…ç½®ã€‚ä¾‹å¦‚ï¼Œ`myapp` åŒ…å¯ä»¥æœ‰å¤šä¸ª Python ç‰ˆæœ¬çš„å˜ä½“ï¼š

```python
variants = [
    ["python-3.7"],
    ["python-3.9"],
    ["python-3.11"],
]
```

æ¯ä¸ªå˜ä½“å¯ä»¥æœ‰ä¸åŒçš„ä¾èµ–é¡¹ã€‚ä¾‹å¦‚ï¼Œ`python-3.7` å˜ä½“å¯èƒ½éœ€è¦ç‰¹å®šç‰ˆæœ¬çš„åº“ï¼Œè€Œ `python-3.9` å˜ä½“å¯èƒ½éœ€è¦å¦ä¸€ä¸ªç‰ˆæœ¬çš„åº“ã€‚æ¡ä»¶ä¾èµ–å¯ä»¥é€šè¿‡ `requires` å­—æ®µä¸­çš„æ¡ä»¶è¡¨è¾¾å¼æ¥å®ç°ã€‚ä¾‹å¦‚ï¼š

```python
requires = [
    "python-3.7+<4",
    "numpy-1.18+<2",
]
```

è¿™è¡¨ç¤º `myapp` åŒ…éœ€è¦ Python 3.7 æˆ–æ›´é«˜ç‰ˆæœ¬ä½†ä½äº 4ï¼Œä»¥åŠ NumPy 1.18 æˆ–æ›´é«˜ç‰ˆæœ¬ä½†ä½äº 2ã€‚

**Section sources**
- [package.py](file://my_packages/myapp/1.0.0/package.py#L25-L29)

## ç¯å¢ƒé…ç½®æ–‡ä»¶ç¼–å†™è§„èŒƒ

ç¯å¢ƒé…ç½®æ–‡ä»¶ï¼ˆ`package.py`ï¼‰æ˜¯ Rez åŒ…çš„æ ¸å¿ƒï¼Œå¿…é¡»éµå¾ªä¸€å®šçš„è§„èŒƒã€‚ä»¥ä¸‹æ˜¯ç¼–å†™ `package.py` æ–‡ä»¶çš„ä¸€äº›æœ€ä½³å®è·µï¼š

1. **å‘½åå’Œç‰ˆæœ¬**ï¼šç¡®ä¿ `name` å’Œ `version` å­—æ®µæ­£ç¡®æ— è¯¯ã€‚
2. **ä¾èµ–å£°æ˜**ï¼šä½¿ç”¨ `requires` å­—æ®µå£°æ˜æ‰€æœ‰ä¾èµ–é¡¹ï¼Œç¡®ä¿ç‰ˆæœ¬èŒƒå›´åˆç†ã€‚
3. **ç¯å¢ƒå˜é‡**ï¼šåœ¨ `commands` å‡½æ•°ä¸­è®¾ç½®å¿…è¦çš„ç¯å¢ƒå˜é‡ï¼Œç¡®ä¿è·¯å¾„æ­£ç¡®ã€‚
4. **å˜ä½“å®šä¹‰**ï¼šä½¿ç”¨ `variants` å­—æ®µå®šä¹‰åŒ…çš„ä¸åŒé…ç½®ï¼Œç¡®ä¿æ¯ä¸ªå˜ä½“çš„ä¾èµ–é¡¹æ­£ç¡®ã€‚
5. **å·¥å…·å®šä¹‰**ï¼šä½¿ç”¨ `tools` å­—æ®µå®šä¹‰åŒ…æä¾›çš„å·¥å…·ï¼Œç¡®ä¿è·¯å¾„æ­£ç¡®ã€‚

**Section sources**
- [package.py](file://my_packages/myapp/1.0.0/package.py#L1-L33)

## å¸¸è§é”™è¯¯ä¸è°ƒè¯•æ–¹æ³•

åœ¨ä½¿ç”¨ Rez åˆ›å»ºç¯å¢ƒæ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°ä¸€äº›å¸¸è§é”™è¯¯ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„é”™è¯¯åŠå…¶è§£å†³æ–¹æ³•ï¼š

1. **ä¾èµ–å†²çª**ï¼šå½“å¤šä¸ªåŒ…ä¾èµ–åŒä¸€ä¸ªåŒ…çš„ä¸åŒç‰ˆæœ¬æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°ä¾èµ–å†²çªã€‚å¯ä»¥é€šè¿‡è°ƒæ•´ä¾èµ–é¡¹çš„ç‰ˆæœ¬èŒƒå›´æ¥è§£å†³ã€‚
2. **ç¼“å­˜é—®é¢˜**ï¼šå¦‚æœç¼“å­˜ä¸­çš„è§£æç»“æœè¿‡æœŸï¼Œå¯èƒ½ä¼šå¯¼è‡´è§£æå¤±è´¥ã€‚å¯ä»¥æ¸…é™¤ç¼“å­˜å¹¶é‡æ–°è§£æã€‚
3. **è·¯å¾„é—®é¢˜**ï¼šç¡®ä¿æ‰€æœ‰è·¯å¾„æ­£ç¡®ï¼Œç‰¹åˆ«æ˜¯åœ¨è·¨å¹³å°ä½¿ç”¨æ—¶ã€‚
4. **æƒé™é—®é¢˜**ï¼šç¡®ä¿æœ‰è¶³å¤Ÿçš„æƒé™è®¿é—®æ‰€éœ€çš„æ–‡ä»¶å’Œç›®å½•ã€‚

è°ƒè¯•æ–¹æ³•åŒ…æ‹¬ï¼š
- ä½¿ç”¨ `--verbose` é€‰é¡¹æŸ¥çœ‹è¯¦ç»†çš„è§£æè¿‡ç¨‹ã€‚
- æ£€æŸ¥æ—¥å¿—æ–‡ä»¶ä»¥è·å–æ›´å¤šä¿¡æ¯ã€‚
- ä½¿ç”¨ `rez-context` å·¥å…·æ£€æŸ¥å·²è§£æçš„ç¯å¢ƒã€‚

**Section sources**
- [resolver.py](file://rez-3.3.0/src/rez/resolver.py#L1-L475)
- [resolved_context.py](file://rez-3.3.0/src/rez/resolved_context.py#L1-L200)

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

ä¸ºäº†æé«˜ Rez ç¯å¢ƒåˆ›å»ºçš„æ€§èƒ½ï¼Œå¯ä»¥é‡‡å–ä»¥ä¸‹æªæ–½ï¼š

1. **ç¼“å­˜ç­–ç•¥**ï¼šå¯ç”¨ç¼“å­˜ä»¥åŠ é€Ÿè§£æè¿‡ç¨‹ã€‚å¯ä»¥é€šè¿‡è®¾ç½® `caching=True` æ¥å¯ç”¨ç¼“å­˜ã€‚
2. **æœ€å°åŒ–ä¾èµ–é›†**ï¼šå°½é‡å‡å°‘ä¸å¿…è¦çš„ä¾èµ–é¡¹ï¼Œä»¥å‡å°‘è§£ææ—¶é—´å’Œèµ„æºæ¶ˆè€—ã€‚
3. **é¢„åŠ è½½åŒ…**ï¼šé¢„åŠ è½½å¸¸ç”¨çš„åŒ…ï¼Œä»¥å‡å°‘é¦–æ¬¡è§£æçš„æ—¶é—´ã€‚
4. **å¹¶è¡Œè§£æ**ï¼šåˆ©ç”¨å¤šæ ¸å¤„ç†å™¨å¹¶è¡Œè§£æå¤šä¸ªåŒ…ï¼Œä»¥æé«˜è§£æé€Ÿåº¦ã€‚

**Section sources**
- [resolver.py](file://rez-3.3.0/src/rez/resolver.py#L1-L475)
- [resolved_context.py](file://rez-3.3.0/src/rez/resolved_context.py#L1-L200)

## å®é™…ä»£ç ç¤ºä¾‹

ä»¥ä¸‹æ˜¯ä¸€ä¸ªåˆ›å»ºå¸¦å‘½åå˜ä½“ã€å¤šç‰ˆæœ¬å…±å­˜ç¯å¢ƒçš„å®é™…ä»£ç ç¤ºä¾‹ï¼š

```python
#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
Rez åŒ…åˆ›å»ºç¤ºä¾‹
æ¼”ç¤ºå¦‚ä½•åˆ›å»ºä¸€ä¸ªç®€å•çš„ Rez åŒ…
"""

import os
import sys
from pathlib import Path

print("=" * 70)
print("Rez åŒ…åˆ›å»ºæ¼”ç¤º")
print("=" * 70)

# å®šä¹‰åŒ…çš„ç›®å½•ç»“æ„
packages_dir = Path("./my_packages")
package_name = "myapp"
version = "1.0.0"
package_dir = packages_dir / package_name / version

print(f"\n1. åˆ›å»ºåŒ…ç›®å½•ç»“æ„...")
print(f"   ç›®å½•: {package_dir}")

# åˆ›å»ºç›®å½•
package_dir.mkdir(parents=True, exist_ok=True)

# åˆ›å»º package.py æ–‡ä»¶
package_py_content = '''"""
ç¤ºä¾‹ Rez åŒ…
"""

name = "myapp"
version = "1.0.0"
description = "A sample Rez package"
authors = ["Your Name"]

# åŒ…çš„ä¾èµ–é¡¹
requires = [
    "python-2.7,3.7+<4",  # Python 2.7 æˆ– 3.7+
]

# å¯é€‰ï¼šå®šä¹‰ç³»ç»Ÿéœ€æ±‚
system_requires = []

# å¯é€‰ï¼šåœ¨ç¯å¢ƒä¸­åŠ è½½æ—¶æ‰§è¡Œçš„å‘½ä»¤
def commands():
    import os
    # è®¾ç½®ç¯å¢ƒå˜é‡
    env.MYAPP_ROOT = "{root}"
    env.PATH.append("{root}/bin")
    env.PYTHONPATH.append("{root}/lib")

# å¯é€‰ï¼šå®šä¹‰åŒ…çš„å˜ä½“ï¼ˆä¸åŒçš„é…ç½®ï¼‰
variants = [
    ["python-3.7"],
    ["python-3.9"],
    ["python-3.11"],
]

# å¯é€‰ï¼šé¡¹ç›®æ–‡ä»¶å¤¹
tools = []
'''

package_py_path = package_dir / "package.py"
package_py_path.write_text(package_py_content, encoding='utf-8')
print(f"   âœ“ åˆ›å»ºäº† {package_py_path}")

# åˆ›å»º bin ç›®å½•å’Œç¤ºä¾‹è„šæœ¬
bin_dir = package_dir / "bin"
bin_dir.mkdir(exist_ok=True)

example_script = '''#!/usr/bin/env python
"""ç¤ºä¾‹åº”ç”¨è„šæœ¬"""
print("Hello from myapp v1.0.0!")
import os
print(f"MYAPP_ROOT: {os.environ.get('MYAPP_ROOT', 'Not set')}")
'''

script_path = bin_dir / "myapp.py"
script_path.write_text(example_script, encoding='utf-8')
print(f"   âœ“ åˆ›å»ºäº† {script_path}")

# åˆ›å»º lib ç›®å½•
lib_dir = package_dir / "lib"
lib_dir.mkdir(exist_ok=True)

init_py = lib_dir / "__init__.py"
init_py.write_text("# myapp library\n", encoding='utf-8')
print(f"   âœ“ åˆ›å»ºäº† {init_py}")

# åˆ›å»º README
readme_path = package_dir / "README.md"
readme_content = """# myapp

ç¤ºä¾‹ Rez åŒ…

## ç”¨é€”
è¿™æ˜¯ä¸€ä¸ªæ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ Rez åŒ…ç®¡ç†ç³»ç»Ÿçš„ç¤ºä¾‹åŒ…ã€‚

## ä¾èµ–é¡¹
- python-2.7 æˆ– 3.7+

## ä½¿ç”¨æ–¹æ³•

### åŠ è½½ç¯å¢ƒ
```bash
python -m rez.cli env myapp
```

### åœ¨ç¯å¢ƒä¸­æ‰§è¡Œå‘½ä»¤
```bash
python -m rez.cli env myapp -- python bin/myapp.py
```

### ä½¿ç”¨ç‰¹å®šçš„ Python ç‰ˆæœ¬
```bash
python -m rez.cli env myapp-3.11
```
"""
readme_path.write_text(readme_content, encoding='utf-8')
print(f"   âœ“ åˆ›å»ºäº† {readme_path}")

print(f"\n2. åŒ…ç»“æ„:")
for root, dirs, files in os.walk(package_dir):
    level = root.replace(str(package_dir), '').count(os.sep)
    indent = ' ' * 2 * level
    rel_path = os.path.relpath(root, package_dir)
    if rel_path != '.':
        print(f"{indent}ğŸ“ {os.path.basename(root)}/")
    else:
        print(f"   ğŸ“ {package_name}-{version}/")
    sub_indent = ' ' * 2 * (level + 1)
    for file in files:
        print(f"{sub_indent}ğŸ“„ {file}")

print(f"\n3. éªŒè¯åŒ…é…ç½®...")
from pathlib import Path
import sys

sys.path.insert(0, str(package_dir))
try:
    # è¯»å–å¹¶è§£æ package.py
    package_py_text = package_py_path.read_text(encoding='utf-8')
    
    # æ¨¡æ‹ŸåŒ…ä¿¡æ¯
    print(f"   âœ“ package.py è¯­æ³•æ­£ç¡®")
    print(f"\n   åŒ…ä¿¡æ¯:")
    print(f"   - åç§°: myapp")
    print(f"   - ç‰ˆæœ¬: 1.0.0")
    print(f"   - ä¾èµ–é¡¹: python-2.7,3.7+<4")
    print(f"   - å˜ä½“: python-3.7, python-3.9, python-3.11")
    
except Exception as e:
    print(f"   âœ— é”™è¯¯: {e}")

print(f"\n4. åç»­æ­¥éª¤:")
print(f"""
   a) æ„å»ºåŒ…åˆ° Rez ä»“åº“:
      cd {package_dir}
      python -m rez.cli build .

   b) åŠ è½½åŒ…ç¯å¢ƒ:
      python -m rez.cli env myapp

   c) é…ç½® REZ_PACKAGES_PATH ä»¥æœç´¢æœ¬åœ°åŒ…:
      export REZ_PACKAGES_PATH={packages_dir}:$REZ_PACKAGES_PATH  (Linux/Mac)
      set REZ_PACKAGES_PATH={packages_dir};%REZ_PACKAGES_PATH%    (Windows CMD)
      $env:REZ_PACKAGES_PATH = "{packages_dir};$env:REZ_PACKAGES_PATH"  (PowerShell)

   d) ç„¶åå°±å¯ä»¥æœç´¢å¹¶ä½¿ç”¨è¯¥åŒ…:
      python -m rez.cli search myapp
      python -m rez.cli env myapp
""")
```

è¿™ä¸ªè„šæœ¬åˆ›å»ºäº†ä¸€ä¸ªåä¸º `myapp` çš„ Rez åŒ…ï¼ŒåŒ…å«å¤šä¸ª Python ç‰ˆæœ¬çš„å˜ä½“ï¼Œå¹¶è®¾ç½®äº†å¿…è¦çš„ç¯å¢ƒå˜é‡ã€‚é€šè¿‡è¿è¡Œè¿™ä¸ªè„šæœ¬ï¼Œå¯ä»¥å¿«é€Ÿåˆ›å»ºä¸€ä¸ªå®Œæ•´çš„ Rez åŒ…ã€‚

**Section sources**
- [create_package_example.py](file://create_package_example.py#L1-L179)

## ç»“è®º

Rez æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„åŒ…ç®¡ç†ç³»ç»Ÿï¼Œé€šè¿‡ `package.py` æ–‡ä»¶å®šä¹‰åŒ…ä¾èµ–å¹¶ç”Ÿæˆè§£æä¸Šä¸‹æ–‡ã€‚ä¾èµ–è§£ææœºåˆ¶ç”± `resolver.py` ä¸­çš„ `Resolver` ç±»å®ç°ï¼Œæ”¯æŒç¼“å­˜å’Œå¤šç‰ˆæœ¬å…±å­˜ã€‚å˜ä½“å’Œæ¡ä»¶ä¾èµ–ä½¿å¾—åŒ…å¯ä»¥é€‚åº”ä¸åŒçš„é…ç½®éœ€æ±‚ã€‚ç¼–å†™è§„èŒƒçš„ç¯å¢ƒé…ç½®æ–‡ä»¶ã€è¯†åˆ«å’Œè§£å†³å¸¸è§é”™è¯¯ã€ä»¥åŠé‡‡å–æ€§èƒ½ä¼˜åŒ–æªæ–½ï¼Œå¯ä»¥æ˜¾è‘—æé«˜ Rez ç¯å¢ƒåˆ›å»ºçš„æ•ˆç‡å’Œå¯é æ€§ã€‚é€šè¿‡å®é™…ä»£ç ç¤ºä¾‹ï¼Œå¯ä»¥æ›´å¥½åœ°ç†è§£å’Œåº”ç”¨è¿™äº›æ¦‚å¿µã€‚

**Section sources**
- [README.md](file://README.md#L1-L155)
- [create_package_example.py](file://create_package_example.py#L1-L179)